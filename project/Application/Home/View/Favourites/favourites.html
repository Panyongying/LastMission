<extend name="Base:base" />

<block name="title"><title>H&M_Favourites</title></block>
 <block name="main">

<main role="main" class="responsive fill">

	<div class="wrapper">    
		<nav class="breadcrumbs">
			<ul>
				<li>		
					<a href="__APP__/Home/Index/index">HM.COM</a>
				</li>

			</ul>
		</nav>
				

		<div class="wrapper">
			<h1 class="favorite-heading">收藏</h1>
			<div>
				
				<ul class="product-detail-list responsive favorite-list js-favorite-list" id="favouritesPage-items" style="display:block">

					<foreach name="array" item="v" key="k">
					<li class="product-detail-list-item" >
						<div class="product-detail-list-item-image-wrapper">
								<div class="wrapper-inner">
									<a href="" class="product-detail-list-item-image ">
										<div class="marker icon-club-price" >9</div> 
													
										<img src="{$v[0]['pic']}" class="product-detail-list-item-image-image" alt=""title="" />
												
												
									</a>
								</div>
						</div>


						<div class="product-detail-list-item-details">
										
								<div class="product-detail-list-item-price-info">
									<p class="product-detail-list-item-total-price">{$k+1}</p>
								</div>


								<div>
									<img alt=""  class="label"/>
												
								</div>
								<h3 class="sub-sub-heading"></h3>

								<div>
									<p class="product-detail-price"  >
										{$v[0]['name']}
									</p>	
									<p class="club-price-text" >
										<span class="club-price">￥{$v[0]['price']}</span>  			
									</p>
								</div>
								<div>
									<p  class="product-detail-price">
											
										<span class="original-price"></span>
											
									</p>			
											
								</div>
								<p class="product-detail-selection"></p>

								<dl class="product-detail-list-item-details-list">
									<dt>
										商品编号：</dt>
									<dd> {$v[0]['id']}</dd>
									<dt>颜色：</dt>
												
									<dd>
										
								<select class="add-to-bag select-size" name="favorite-add-to-bag-options-1"
												
													>
													
									<option value="">选择颜色和尺码</option>
								
									<foreach name="v" item="value" k="key">
									<option 
										value="{$v[$key]['aid']}" >{$v[$key][color]} / {$v[$key][size]}码
									</option>
									</foreach>
								</select>

									</dd>
								</dl>
						</div>




						<div class="product-detail-list-item-actions favorite-list-actions">
							<button class="button secondary icon del-fav icon-trash" value="{$v[0]['fid']}" type="button"
											title=从收藏中移除>从收藏中移除</button>
											
										
							<label class="product-detail-list-item-actions-label"for="favorite-options-1"></label>
											
							<div class="favorite-add-to-bag icon-add-to-bag">

								<select class="add-to-bag add-car" data-fid="{$v[0]['fid']}" data-value="{$v[0]['id']}" name="favorite-add-to-bag-options-1"
													
													title=加入购物袋>
													
								</select>
							</div>
						</div>
					</li>
		</foreach>
				</ul>
			<if condition="empty($array)">
				<div style="display:block">
			<else />
				<div style="display:none">
			</if>

		
					<section class="segment favorites-empty"  >
						<h3 class="heading icon-favorites">
							收藏您喜欢的商品
						</h3>
						<p class="text"  >
							 希望收藏喜欢的商品？点击商品上的心形符号，便可在此处显示。
						</p>
						<a class="button" href="__APP__/Home/Index/index">现在查看</a>
					</section>
				</div> 
			</div>

			<div class="hidden modal-content fadeInModal" style="margin-top: 91.5px;" id="error-popup">
				<button class="modalclose icon-close-black"></button>
				<h1 class="sticky heading"></h1>
				<div class="modal-wrapper" style="max-height: 140px;">
					<div class="modal-content">
						<div class="modal-text">
							<p class="text"></p>
						</div>
						<div class="sticky button-group">
							<button  class="modalclose button">	确定</button> 
									
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<script>
		$('.del-fav').click(function () {

			var that = $(this);
			$.post('__URL__/delFavorite', {

				id:that.val(),

			}, function (data) {

				if (data== 1){

					that.parent().parent().remove();

				} else {


					show_msg('删除失败');
				}



			}, 'json');

		});

		$('.add-car').click(function () {

			var that = $(this);

			if (that.parent().parent().prev().find('.select-size').val() == ''){

				show_msg('请选择你的颜色和尺码');

				return false;

			}


			$.post('__URL__/addGoodscar', {

				aid:that.parent().parent().prev().find('.select-size').val(),

				gid:that.attr('data-value'),

				fid:that.attr('data-fid'),

			}, function (data){

				if(data != 0){

					that.parent().parent().parent().remove();
				}

			}, 'json');


		});




		function show_msg(msg){	

			 $('body').append('<div class="sub_err" style="position:absolute;top:60px;left:0;width:500px;z-index:999999;"></div>');

				var htmltop='<div class="bac" style="padding:8px 0px;border:1px solid #090;width:100%;margin:0 auto;background-color:white;color:#0d0d0d;border:2px black solid;text-align:center;font-size:16px;">';

				var htmlfoot = '</div>';

				$('.sub_err').html(htmltop+msg+htmlfoot); 

				var left=($('body').width()-500)/2;

				$('.sub_err').css({'left':left+'px'});

				var scroll_height=$(document).scrollTop();

				 $('.sub_err').animate({'top': scroll_height+120},100);

				 msgdsq=setTimeout(function(){	

					$('.sub_err').animate({'top': scroll_height+80},100);

					setTimeout(function(){	

				 	 $('.sub_err').remove();	

			   		},100);	 
			   
				}, "1200");  
		}	


	</script>
</main>
</block>